# Koopman Flow Configuration File

# Task Configuration
task:
  name: "two_moons"  # SBIBM task name (e.g., "two_moons", "slcp", "bernoulli_glm", etc.)
  num_train_samples: 10000
  batch_size: 1000
  train_fraction: 0.8

# Model Architecture Configuration
model:
  input_dim: null  # Will be set automatically from task
  context_dim: null  # Will be set automatically from task
  lifting_dim: 124  # Dimension of the high-dimensional Koopman space
  
  # Loss function weights
  lambda_rec: 1.0    # Reconstruction loss weight
  lambda_lat: 1.0    # Latent dynamics loss weight  
  lambda_pred: 1.0   # Prediction loss weight
  
  # Network configuration for encoder/decoder
  network_kwargs:
    activation: gelu
    batch_norm: false
    context_with_glu: false
    dropout: 0.0
    hidden_dims: 
    - 64
    - 256
    - 4096
    - 256
    - 64
    theta_with_glu: false
    type: DenseResidualNet

# Training Configuration
training:
  epochs: 100
  batch_size: 64
  num_workers: 4
  device: "cpu"  # or "cuda" if available
  
  # Optimizer settings
  optimizer:
    name: "Adam"
    lr: 0.001
    weight_decay: 1e-5
    
  # Scheduler settings (optional)
  scheduler:
    type: reduce_on_plateau
    factor: 0.5             # More aggressive learning rate reduction
    patience: 5             # Reduce LR if no improvement for 5 epochs
    
  # Early stopping
  early_stopping: true
  patience: 15
  
  # Logging
  use_tensorboard: true

# Paths and Directories
paths:
  base_logs_dir: "logs"  # Base directory for all logs
  dataset_dir: null      # Will be set to logs/{task_name}/data
  model_dir: null        # Will be set to logs/{task_name}/models
  tensorboard_dir: null  # Will be set to logs/{task_name}/tensorboard

# Data Configuration  
data:
  save_dataset: true     # Whether to save generated dataset
  load_existing: false   # Whether to load existing dataset if available